const NF=require("node-forge"),base64To=require("./base64To");function messageEncryptToChunks(e,r,n=200){if(!e)return"";if(!r||!r.includes("-----BEGIN PUBLIC KEY-----")||!r.includes("-----END PUBLIC KEY-----"))throw new Error("Public Key is not well PEM formatted");n<0||!n?n=200:n>214&&(n=214,console.warn("MiscHelpers: NodeForge - Encription with public key the maximum chunk size is 214!"));const o=[],s=NF.pki.publicKeyFromPem(r);for(let r=0;r<e.length;r+=n)o.push(base64To(s.encrypt(e.substring(r,r+n),"RSA-OAEP")));return o.join(",")}module.exports=messageEncryptToChunks;