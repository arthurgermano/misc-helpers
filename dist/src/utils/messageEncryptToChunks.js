const NF=require("node-forge");function messageEncryptToChunks(e,n,r=200){if(!e)return"";if(!n||!n.includes("-----BEGIN PUBLIC KEY-----")||!n.includes("-----END PUBLIC KEY-----"))throw new Error("Public Key is not well PEM formatted");r<0||!r?r=200:r>214&&(r=214,console.warn("MiscHelpers: NodeForge - Encription with public key the maximum chunk size is 214!"));const o=[],i=NF.pki.publicKeyFromPem(n);for(let n=0;n<e.length;n+=r)o.push(NF.util.encode64(i.encrypt(e.substring(n,n+r),"RSA-OAEP")));return o.join(",")}module.exports=messageEncryptToChunks;