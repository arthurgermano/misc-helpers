const NF=require("node-forge"),base64To=require("./base64To"),uint8ArrayFromString=require("./uint8ArrayFromString");function messageEncryptToChunks(r,e,n=200){if(!r)return"";if(!e||!e.includes("-----BEGIN PUBLIC KEY-----")||!e.includes("-----END PUBLIC KEY-----"))throw new Error("Public Key is not well PEM formatted");n<0||!n?n=200:n>214&&(n=214,console.warn("MiscHelpers: NodeForge - Encription with public key the maximum chunk size is 214!"));const i=[],o=NF.pki.publicKeyFromPem(e);for(let e=0;e<r.length;e+=n)i.push(base64To(uint8ArrayFromString(o.encrypt(r.substring(e,e+n),"RSA-OAEP"),",")));return i.join(",")}module.exports=messageEncryptToChunks;